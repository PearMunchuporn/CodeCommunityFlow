@model CodeCommunityFlow.ViewModelFiles.UpdateUserImage
@{
    ViewBag.Title = "Change Profile";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@if (TempData["SuccessChangeProfile"] != null)
{
    <div class="alert alert-success" id="successAlert">@TempData["SuccessChangeProfile"]</div>
}
<div class="container mt-5">
    <h3>Change your profile</h3>
    <br />
    <form id="ChangeProfileForm" method="post" class="needs-validation" asp-action="ChangeProfile" asp-controller="Account" novalidate enctype="multipart/form-data">
        @Html.AntiForgeryToken()

        <div class="col-md-6">
            <div class="form-group">
                <label for="Name">User Name</label>
                <input type="text" class="form-control" id="Name" name="UserName" placeholder="Update your user name" required value="@Model.UserName" />
                <div class="invalid-feedback">Username is required.</div>
            </div>

            <div class="form-group">
                <label for="Email"><b>Your Email: </b></label><br />
                <input type="text" value="@Model.Email" name="Email" required class="form-control" />
            </div>

            <div class="form-group">
                <label for="Email"><b>Add Your Image (Optional): </b></label><br />
                <input type="file" name="FilesImageUser" class="form-control" />
                <input type="hidden" value="@Model.ImageUser" name="ImageUserOld" class="form-control" />
            </div>

            @Html.ValidationSummary()
            <button type="submit" class="btn btn-primary">Update Profile</button>
        </div>
    </form>
</div>

<script>
    $(document).ready(function () {
        $("a[href='/account/changeprofile']").attr("id", "active");
    })

    $(document).on("submit", ".needs-validation", validate)
    $(".needs-validation input").blur(validate)
    function validate(e) {
        if ($(".needs-validation")[0].checkValidity() == false) {
            e.preventDefault();

        }
        $(".needs-validation")[0].classList.add("was-validated")
    }

    setTimeout(function () {
        var alert = document.getElementById("successAlert");
        if (alert) {
            alert.classList.remove("show");
            alert.classList.add("fade");
            alert.style.opacity = 0;
            setTimeout(() => alert.remove(), 500);
        }
    }, 3000);
</script>
